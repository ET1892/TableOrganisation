<!DOCTYPE html>
<html>

  

<body onload="addListnerToTable();cloneTable()">

<h3 id ="Title">Ethan Toomey 21521199</h3></nbsp>
</head>




<table id="myTable" oninput="sum()">
    <thead>
    <tr>
        <th>Sudent Name</th>
        <th>Sudent ID</th>
        <th>Asignment 1</th>
        <th>Asignment 2</th>
        <th>Asignment 3</th>
        <th>Asignment 4</th>
        <th>Asignment 5</th>
        <th id = avg  onclick="toggleGrades()">Average (%)</th>
    </tr>
    </thead>




    <tbody  contenteditable="true" >


    



    <tr>
        <td>Ethan Toomey</td>
        <td>21523366</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
    </tr>



    <tr>
        <td>Sadbh Flynn</td>
        <td>21424187</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
    </tr>



    <tr>
        <td>Penny Sarah</td>
        <td>21399457</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
    </tr>




    <tr>
        <td>Hugh Mungus</td>
        <td>21399988</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
    </tr>




    <tr>
        <td>Sarah ONiel</td>
        <td>24148056</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
    </tr>



    <tr>
        <td>Barbara Samp</td>
        <td>21456789</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
    </tr>



    <tr>
        <td>Leona Maguire</td>
        <td>21455221</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
    </tr>




    <tr>
        <td>Graham Duffy</td>
        <td>24144228</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
    </tr>





    <tr>
        <td>Tony Elizabeth</td>
        <td>21441122</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
    </tr>




    <tr>
        <td>Skingly Dong</td>
        <td>21685754</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
        <td class = "missing">-</td>
    </tr>
    </tbody>
</table>



<p id=missingGrades>Missing Grades</p>
<div id="buttons">
    <button id="addR"type="button" onclick="addRow()">Add row</button>
    <button id="removeRow" onclick="deleteRow()">Delete row</button>
    </br>
    <button id="addC" onclick="addColumn()">Add column</button>
    <button id="removeC" onclick="deleteColumn()">Delete column</button>
    </br>
    <button id="restart" onclick="reset()">Reset</button>
</div>
</body>

</html>









<style>







.missing
{
    text-align: center;
}





table, td
{
  font-family: sans-serif;
  border: 1px solid black;
  border-collapse: collapse;
  margin-left: auto;
  padding: 8px;
  margin-right: auto;
}



th
{
  background-color: grey;

}




thead tr th:first-child, thead tr th, thead 
{
  border: 2px solid black;
  border-left: 2px solid black;
}





table tr:nth-child(even) 
{
  background-color: lightgrey;
}







#Title 
{
  font-family: sans-serif;
  margin-top: 100px;
  text-align: center;
  font-size: 35px;
}





#missingGrades 
{
  font-family: sans-serif;
  text-align: center;
  font-size: 24px;
  color: red;
}





#buttons
{
  justify-content: center;
  display: flex;
}




#addR 
{
  background-color: green;
  border: 3px solid white;
  color: white;
  padding: 15px 30px;
  text-align: center;
  font-size: 15px;
  order: 1;
}


#addC 
{
  background-color: green;

  color: white;
  border: 3px solid white;
  padding: 15px 30px;
  text-align: center;
  font-size: 15px;
  order: 2;
}


#removeRow 
{
  background-color: red;
  border: 3px solid white;
  color: white;
  padding: 15px 30px;
  text-align: center;
  font-size: 15px;
  order: 3;
}






#removeC 
{
  background-color: red;
  border: 3px solid white;
  color: white;
  padding: 15px 30px;
  text-align: center;
  font-size: 15px;
  order: 4;
}




#restart 
{
  background-color: grey;
  border: 3px solid white;
  color: white;
  padding: 15px 30px;
  text-align: center;
  font-size: 15px;
  order: 5;
}







</style>
















<script>

var averageGradeType = 1;
let initTable;


function cloneTable()
{
    var copy=document.getElementsByTagName("myTable")[0];
    initTable = myTable.cloneNode(true);
}






function reset()
{
    document.getElementById("myTable").replaceWith(initTable);
    addListnerToTable();
    cloneTable();
  document.getElementById('missingGrades').innerHTML='Missing grades';
}





function strip(cell)
{
    var rowNo=cell.parentNode.rowIndex;
    var cellNo=cell.cellIndex;
    var tableBody = document.getElementById("myTable").tBodies[0];
    if(cellNo > 1 && cellNo < tableBody.rows.length-1)
    {
        var row = tableBody.rows[rowNo-1];
        var cell =row.cells[cellNo];
        cell.innerHTML='';
    }




    //change color of row on name click
  if(cellNo ==0)
  {
        var row = tableBody.rows[rowNo-1];
        var style = window.getComputedStyle(cell);
        console.log(style.backgroundColor);
        if(style.backgroundColor === "rgba(0, 0, 0, 0)")
        {
            console.log("white");
            for(var j = 0 ; j<row.cells.length;j++)
            {
                row.cells[j].style.backgroundColor="green";
            }
        }else{
            for(var j = 0 ; j<row.cells.length;j++)
            {
                row.cells[j].style.backgroundColor="rgba(0, 0, 0, 0)";
            }
            sum();
        }
    }
 }






function addListnerToTable(){
    var tableBody = document.getElementById("myTable").tBodies[0];
    for (var i=0; i<tableBody.rows.length; i++) 
    {
        var row = tableBody.rows[i];
        for(j=0;j<row.cells.length;j++){
            row.cells[j].onclick = (function()
            {         strip(this) });
        }
    }
}






function deleteRow() {
    var x = document.getElementById("myTable");
    x.deleteRow(-1);
}







function addRow() {
    var tableHead = document.getElementById('myTable').tHead;
    var headerRow = tableHead.rows[0];
    var table = document.getElementById("myTable");
    var row = table.insertRow(-1);
    for(var i = 0 ; i < headerRow.cells.length ; i++)
    {
        var x = row.insertCell(i)
        x.innerHTML = "-";
    }

    addListnerToTable();

}







function addColumn() 
{
    var tableHead = document.getElementById('myTable').tHead;
    var headerRow = tableHead.rows[0];
    var secondLastIndex = headerRow.cells.length-1;
    var lastAssignmentHead = tableHead.rows[0].cells[secondLastIndex-1].innerHTML;

    var lastAssignmentNumber = lastAssignmentHead.replace(/[^0-9]/g, "");
    var newHead = Number(lastAssignmentNumber) +1; // "500"

    var newItem = document.createElement("th");
    newItem.innerHTML="Assignment "+ newHead;
    tableHead.childNodes[1].insertBefore(newItem, tableHead.childNodes[1].cells[secondLastIndex]);

    var tableBody = document.getElementById("myTable").tBodies[0];
    for (var i=0; i<tableBody.rows.length; i++) 
    {
        var newCell = tableBody.rows[i].insertCell(secondLastIndex);
        newCell.innerHTML = '-'
    }

    addListnerToTable();
    sum();
}









function deleteColumn() {
    var tableHead = document.getElementById('myTable').tHead;
    var headerRow = tableHead.rows[0];
    var secondLastIndex = headerRow.cells.length-1;
    var lastAssignmentHead = tableHead.rows[0].cells[secondLastIndex-1].innerHTML;
    tableHead.rows[0].cells[secondLastIndex-1].remove();
    var tableBody = document.getElementById("myTable").tBodies[0];
    for (var i=0; i<tableBody.rows.length; i++) {
        tableBody.rows[i].cells[secondLastIndex].remove();
    }

    for (var i=0; i<tableBody.rows.length; i++) {
        tableBody.rows[i].cells[secondLastIndex-1].innerHTML='-';
    }

    sum();
}





function sum() 
{
    var tableBody = document.getElementById("myTable").tBodies[0];
    var sumOfUnSubmitted=0;
    for (var i=0; i<tableBody.rows.length; i++) 
    {
        var sum = 0;
        var sumOfAssignemtsSubmitted = 0;
        var singleRow=tableBody.rows[i];
        for(var j=0;j<singleRow.cells.length;j++){
            if(j==0 || j==1 ){

            }
            else {
                if( (singleRow.cells[j].innerHTML == '-') && (j != singleRow.cells.length-1) )
                {
                    sumOfUnSubmitted=sumOfUnSubmitted+1;
                    singleRow.cells[j].style.backgroundColor = "yellow"
                }else if(!isNumeric(singleRow.cells[j].innerHTML) && (j != singleRow.cells.length-1))
                {
                    singleRow.cells[j].innerHTML = '-';
                    singleRow.cells[j].style.backgroundColor = "yellow"
                }else{
                    if((j != singleRow.cells.length-1)){
                        singleRow.cells[j].style.backgroundColor = "white"
                        sum += Number(singleRow.cells[j].innerHTML);
                        sumOfAssignemtsSubmitted+=1;
                    }
                }




                // if its the last col set the average
                //calculates row average
                if(j == singleRow.cells.length-1 && sumOfAssignemtsSubmitted !=0 ) 
                {
                    var percentValue=Math.round(sum/sumOfAssignemtsSubmitted);
                    console.log(percentValue);
                    mapGradeToType(percentValue,singleRow,j);
                    if(percentValue<60){
                        singleRow.cells[j].style.backgroundColor = "red";
                        singleRow.cells[j].style.color="white";
                    }
                    if(percentValue>60){
                        singleRow.cells[j].style.backgroundColor = "white";
                        singleRow.cells[j].style.color="black";
                    }
                }

            }
        }
    }
    //works out missing grades
    document.getElementById('missingGrades').innerHTML='Missing grades : ' +sumOfUnSubmitted;
}


function mapGradeToType(percentValue,singleRow , j)
{
    if(averageGradeType==1)
    {
        singleRow.cells[j].innerHTML=percentValue;
    }else if(averageGradeType==2)
    
    
    {
        if(percentValue>=93){
            singleRow.cells[j].innerHTML='A';
        }




        else if(percentValue>= 90 && percentValue <=92 )
        {
            singleRow.cells[j].innerHTML='A-';
        }



        else if(percentValue>= 87 && percentValue <=89 )
        {
            singleRow.cells[j].innerHTML='B+';
        }


        else if(percentValue>= 83 && percentValue <=86 )
        {
            singleRow.cells[j].innerHTML='B';
        }




        else if(percentValue>= 80 && percentValue <=82 )
        {
            singleRow.cells[j].innerHTML='B-';
        }



        else if(percentValue>= 77 && percentValue <=79 )
        {
            singleRow.cells[j].innerHTML='C+';
        }




        else if(percentValue>= 73 && percentValue <=76 )
        {
            singleRow.cells[j].innerHTML='C';
        }



        else if(percentValue>= 70 && percentValue <=72 )
        {
            singleRow.cells[j].innerHTML='C-';
        }



        else if(percentValue>= 67 && percentValue <=69 )
        {
            singleRow.cells[j].innerHTML='D+';
        }



        else if(percentValue>= 63 && percentValue <=66 )
        {
            singleRow.cells[j].innerHTML='D';
        }



        else if(percentValue>= 60 && percentValue <=61 )
        {
            singleRow.cells[j].innerHTML='D-';
        }



        else if(percentValue < 62 )
        {
            singleRow.cells[j].innerHTML='F';
        }



    }
    else
    {
        if(percentValue>=93)
        {
            singleRow.cells[j].innerHTML='4.0';
        }




        else if(percentValue>= 90 && percentValue <=92 )
        {
            singleRow.cells[j].innerHTML='3.7';
        }


        else if(percentValue>= 90 && percentValue <=92 )
        {
            singleRow.cells[j].innerHTML='3.7';
        }



        else if(percentValue>= 87 && percentValue <=89 )
        {
            singleRow.cells[j].innerHTML='3.3';
        }



        else if(percentValue>= 83 && percentValue <=86 )
        {
            singleRow.cells[j].innerHTML='3.0';
        }


        else if(percentValue>= 83 && percentValue <=86 )
        {
            singleRow.cells[j].innerHTML='3.0';
        }



        else if(percentValue>= 80 && percentValue <=82 )
        {
            singleRow.cells[j].innerHTML='2.7';
        }



        else if(percentValue>= 77 && percentValue <=79 )
        {
            singleRow.cells[j].innerHTML='2.3';
        }



        else if(percentValue>= 73 && percentValue <=76 )
        {
            singleRow.cells[j].innerHTML='2.0';
        }



        else if(percentValue>= 70 && percentValue <=72 )
        {
            singleRow.cells[j].innerHTML='1.7';
        }



        else if(percentValue>= 67 && percentValue <=69 )
        {
            singleRow.cells[j].innerHTML='1.3';
        }



        else if(percentValue>= 63 && percentValue <=66 )
        {
            singleRow.cells[j].innerHTML='1.0';
        }



        else if(percentValue>= 60 && percentValue <=61 )
        {
            singleRow.cells[j].innerHTML='0.7';
        }



        else if(percentValue < 62 )
        {
            singleRow.cells[j].innerHTML='0.0';
        }



    }

}

//validates number

function isNumeric(n) 
{
    return !isNaN(parseFloat(n)) && isFinite(n);
}





function toggleGrades()
{

    var tableHead = document.getElementById('myTable').tHead;
    var headerRow = tableHead.rows[0];
    var lastColId = headerRow.cells.length;
    var lastCol = headerRow.cells[lastColId-1];


    if(averageGradeType == 3)
    {
        averageGradeType = 1;
    }

    else
    {
        averageGradeType+=1;
    }


    sum();
    if(averageGradeType ==3)
    {
        lastCol.innerHTML="Average [4.0]";
    }



    if(averageGradeType ==2)
    {
        lastCol.innerHTML="Average [Letter]";
    }


    if(averageGradeType ==1)
    {
        lastCol.innerHTML="Average (%)";
    }


}


</script>